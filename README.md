# BTA Minecraft Server Docker

Docker-образ для запуска [BTA](https://www.betterthanadventure.net/) (Better Than Adventure) сервера.

## Переменные окружения

Подробнее можно узнать [тут](https://bta.miraheze.org/wiki/Setting_up_a_server).

| Переменная                             | Оригинальное название          | Значение по умолчанию                                                 | Описание                                                                                                                                                                                                                                                                                                                                           |
| -------------------------------------- | ------------------------------ | --------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `MC_ALLOW_PARADISE`                    | `allow-paradise`               | `false`                                                               | Если установлено значение true, игроки получают доступ к измерению «Рай». Если установлено значение false, доступ к измерению запрещен.                                                                                                                                                                                                            |
| `MC_AUTOSAVE_INTERVAL`                 | `autosaveInterval`             | `5`                                                                   | Устанавливает, как долго (в секундах) сервер должен пытаться автоматически сохранять мир.                                                                                                                                                                                                                                                          |
| `MC_ALLOW_NETHER`                      | `allow-nether`                 | `true`                                                                | Если установлено значение true, игроки могут попасть в измерение Нижнего мира, построив портал в Нижний мир. Если установлено значение false, игроки не могут попасть в измерение Нижнего мира.                                                                                                                                                    |
| `MC_MAX_CHUNKS_SAVED_PER_AUTOSAVE`     | `maxChunksSavedPerAutosave`    | `24`                                                                  | Устанавливает максимальное количество чанков для автосейва.                                                                                                                                                                                                                                                                                        |
| `MC_LEVEL_NAME`                        | `level-name`                   | `world`                                                               | Устанавливает имя мира, который генерируется при запуске сервера.                                                                                                                                                                                                                                                                                  |
| `MC_WORLD_TYPE`                        | `world-type`                   | `minecraft\:overworld.extended`                                       | Определяет тип мира, который генерируется при запуске сервера.                                                                                                                                                                                                                                                                                     |
| `MC_ALLOW_FLIGHT`                      | `allow-flight`                 | `false`                                                               | Если установлено значение «true», игроки могут летать, используя творческий режим или специальные способности. Если установлено значение «false», игроки не могут летать.                                                                                                                                                                          |
| `MC_STATS_TOKEN`                       | `stats-token`                  | `only-enter-a-value-if-you-are-a-registered-server`                   | Токен статистики для общедоступного списка серверов BTA Discord. Большинству пользователей не нужно менять это значение. Используйте его только после запроса токена в Discord и если вы хотите, чтобы ваш сервер был общедоступным.                                                                                                               |
| `MC_SERVER_PORT`                       | `server-port`                  | `25565`                                                               | Устанавливает номер порта, на котором сервер прослушивает входящие соединения.                                                                                                                                                                                                                                                                     |
| `MC_FORCE_SAVE_ALL_CHUNKS_ON_AUTOSAVE` | `forceSaveAllChunksOnAutosave` | `false`                                                               | Устанавливает принудительное сохранение всех чанков для автосейва.                                                                                                                                                                                                                                                                                 |
| `MC_DISABLE_PHOTOMODE`                 | `disable-photomode`            | `false`                                                               | Если установлено значение true, игроки не смогут использовать фоторежим на сервере и делать изометрические скриншоты мира. Если установлено значение false, игроки смогут это делать. Это может потенциально помешать игрокам использовать фоторежим для обмана и обнаружения пещер.                                                               |
| `MC_ENABLE_ITEM_CLUMPING`              | `enable-item-clumping`         | `true`                                                                | Автоматически группирует близлежащие предметы в один, что упрощает и ускоряет их сбор. Уменьшает задержку сервера и улучшает производительность.                                                                                                                                                                                                   |
| `MC_LEVEL_SEED`                        | `level-seed`                   |                                                                       | Устанавливает начальное значение для алгоритма генерации мира. Если поле оставить пустым, будет использовано случайное начальное значение.                                                                                                                                                                                                         |
| `MC_UUID_SERVICE`                      | `uuid-service`                 | `https\://api.minecraftservices.com/minecraft/profile/lookup/name/%s` | Адрес сервиса генерации uuid.                                                                                                                                                                                                                                                                                                                      |
| `MC_SERVER_IP`                         | `server-ip`                    |                                                                       | Устанавливает IP-адрес, на котором сервер прослушивает входящие соединения. По умолчанию сервер прослушивает все доступные IP-адреса.                                                                                                                                                                                                              |
| `MC_SUMMON_LIMIT`                      | `summon-limit`                 | `10`                                                                  | Устанавливает максимальное количество существ, которые можно вызвать одновременно с помощью команды /summon. Увеличение этого значения может привести к нестабильности при использовании команды.                                                                                                                                                  |
| `MC_SLEEP_PERCENTAGE`                  | `sleep-percentage`             | `0`                                                                   | Устанавливает процент игроков, которые должны спать, чтобы пропустить ночной цикл. По умолчанию это значение установлено на 0, что означает, что ночной цикл может быть пропущен только одним игроком.                                                                                                                                             |
| `MC_WHITE_LIST`                        | `white-list`                   | `false`                                                               | Если установлено значение true, к серверу будут допускаться только игроки, чьи имена пользователей указаны в файле белого списка сервера. Если установлено значение false, к серверу будут допускаться все игроки.                                                                                                                                 |
| `MC_DEFAULT_GAMEMODE`                  | `default-gamemode`             | `survival`                                                            | Устанавливает режим игры по умолчанию для игрока. Доступные значения: выживание и творчество.                                                                                                                                                                                                                                                      |
| `MC_SPAWN_ANIMALS`                     | `spawn-animals`                | `true`                                                                | Если установлено значение true, животные будут появляться в мире. Если установлено значение false, животные не будут появляться.                                                                                                                                                                                                                   |
| `MC_LANGUAGE`                          | `language`                     | `en_US`                                                               | Устанавливает язык строк сервера.                                                                                                                                                                                                                                                                                                                  |
| `MC_ONLINE_MODE`                       | `online-mode`                  | `true`                                                                | Если установлено значение true, сервер будет проверять, что у каждого игрока есть действующая учетная запись Minecraft, прежде чем разрешить ему подключиться. Если установлено значение false, игроки смогут присоединиться, даже если их учетная запись Minecraft не может быть проверена, включая игроков без премиум-учетной записи Minecraft. |
| `MC_PVP`                               | `pvp`                          | `true`                                                                | Если установлено значение true, игроки могут наносить друг другу урон.                                                                                                                                                                                                                                                                             |
| `MC_LOGIN_TIMEOUT_TIME`                | `login-timeout-time`           | `90000`                                                               | Настройка времени ожидания аутентификации игрока перед отключением                                                                                                                                                                                                                                                                                 |
| `MC_JOIN_MESSAGE`                      | `join-message`                 |                                                                       | Если этот параметр установлен, игроки будут получать сообщение в чате при подключении к серверу.                                                                                                                                                                                                                                                   |
| `MC_DIFFICULTY`                        | `difficulty`                   | `2`                                                                   | Устанавливает уровень сложности сервера. Используйте 0 для мирного, 1 для легкого, 2 для нормального и 3 для сложного.                                                                                                                                                                                                                             |
| `MC_MAX_PLAYERS`                       | `max-players`                  | `20`                                                                  | Устанавливает максимальное количество игроков, которые могут подключиться к серверу.                                                                                                                                                                                                                                                               |
| `MC_SPAWN_MONSTERS`                    | `spawn-monsters`               | `true`                                                                | Если установлено значение true, монстры будут появляться в мире. Если установлено значение false, монстры не будут появляться.                                                                                                                                                                                                                     |
| `MC_VIEW_DISTANCE`                     | `view-distance`                | `10`                                                                  | Устанавливает максимальное расстояние обзора игрока в чанках.                                                                                                                                                                                                                                                                                      |
| `MC_SPAWN_PROTECTION`                  | `spawn-protection`             | `0`                                                                   | Определяет радиус от точки появления в мире, защищенный от не-операторов.                                                                                                                                                                                                                                                                          |
| `MC_MOTD`                              | `motd`                         | `A Better than Adventure\! Server`                                    | Текст, который отображается рядом с значком сервера и под названием сервера в списке серверов вашего клиента Minecraft                                                                                                                                                                                                                             |
| `MC_PACKET_DELAY`                      | `packet-delay`                 | `1`                                                                   | Определяет время между отправкой пакетов клиентам. Чем меньше значение, тем быстрее.                                                                                                                                                                                                                                                               |
| `MC_OPS`                               |                                |                                                                       | Определяет список операторов сервера в формате `MC_OPS="player1,player2"`                                                                                                                                                                                                                                                                          |
| `MC_WHITELIST`                         |                                |                                                                       | Определяет список игроков в белом списке сервера в формате `MC_WHITELIST="player1,player2"`                                                                                                                                                                                                                                                        |
| `MC_BANNED_IPS`                        |                                |                                                                       | Определяет список забаненых на сервере ip-адресов в формате `MC_WHITELIST="192.168.1.1,192.168.1.2"`                                                                                                                                                                                                                                               |
| `MC_BANNED_PLAYERS`                    |                                |                                                                       | Определяет список забаненых на сервере игроков в формате `MC_WHITELIST="player1,player2"`                                                                                                                                                                                                                                                          |
| `JAVA_OPTS`                            |                                | `-Xms512M -Xmx2G`                                                     | Определяет параметры java для запуска сервера.                                                                                                                                                                                                                                                                                                     |

## Запуск

Пример с bind mount для сохранения данных:

```bash
docker run -d \
  -v /srv/minecraft-data:/opt/minecraft \
  -p 25565:25565 \
  -e MC_OPS="Admin,Mod1" \
  -e MC_WHITELIST="Player1,Player2" \
  -e JAVA_OPTS="-Xms1G -Xmx2G" \
  alexandrshapkin/bta-server:7.3_04
```

* `/srv/minecraft-data` на хосте будет содержать все данные сервера.
* Порт пробрасывается из контейнера наружу через `-p`.
* Образ не содержит в себе файла сервера, он будет загружен при первом запуске контейнера.

### Docker Compose

```yaml
services:
  minecraft:
    image: alexandrshapkin/bta-server:7.3_04
    ports:
      - "25565:25565"
    volumes:
      - /srv/minecraft-data:/opt/minecraft
    environment:
      MC_OPS: "Admin,Mod1"
      MC_WHITELIST: "Player1,Player2"
      JAVA_OPTS: "-Xms1G -Xmx2G"
    restart: unless-stopped
```
